<app-navbar></app-navbar>
<br />
<h1>Onboarding Page</h1>
<!-- <table>
    <thead>
        <th>Name</th>
        <th>Email</th>
        <th>Website</th>
    </thead>
    <tbody>
        <tr *ngFor="let user of users$ | async; let i = index">
            <td>{{ user.name }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.website }}</td>
        </tr>
    </tbody>
</table> -->

<hr />

<!-- <form #myForm="ngForm" *ngIf="status === 'Not Started' || status === 'Rejected'" (ngSubmit)="submitForm()"> -->
<form #myForm="ngForm" *ngIf="status === 'Not Started' || status === 'Rejected'">
    <label>First Name *</label>
    <input type="text" [(ngModel)]="firstName" name="firstName" required>
    <!-- <div *ngIf="firstName.invalid && (firstName.dirty || firstName.touched)">First name is required</div>    <label>Last Name *</label> -->
    <input type="text" [(ngModel)]="lastName" name="lastName" required>

    <label>Middle Name</label>
    <input type="text" [(ngModel)]="middleName" name="middleName">

    <label>Preferred Name</label>
    <input type="text" [(ngModel)]="preferredName" name="preferredName">

    <br />
    <label>Profile Picture</label>
    <input type="file" (change)="onFilePickedPic($event)" accept="image/*">
    <!-- <img [src]="profilePicture"> -->
    <!-- <button (click)="onFileUpload()">Upload Pictue</button> -->
    <button (click)="onFileUpload($event)">Upload Pictue</button>

    <br />
    <label>Current Address </label>
    <label>Apartment*</label>
    <input type="text" [(ngModel)]="apt" name="apt" required>
    <label>Street *</label>
    <input type="text" [(ngModel)]="street" name="street">

    <label>City *</label>
    <input type="text" [(ngModel)]="city" name="city" required>

    <label>State *</label>
    <input type="text" [(ngModel)]="state" name="state" required>

    <label>Zip *</label>
    <input type="text" [(ngModel)]="zip" name="zip" required>
    <br />
    <label>Cell Phone *</label>
    <input type="tel" [(ngModel)]="cellPhone" name="cellPhone" required>

    <label>Work Phone</label>
    <input type="tel" [(ngModel)]="workPhone" name="workPhone">
    <br />
    <label>Car Make</label>
    <input type="text" [(ngModel)]="carMake" name="carMake">

    <label>Car Model</label>
    <input type="text" [(ngModel)]="carModel" name="carModel">

    <label>Car Color</label>
    <input type="text" [(ngModel)]="carColor" name="carColor">
    <br />
    <label>Email *</label>
    <input type="text" readonly [(ngModel)]="email" value={{email}}>
    <label>SSN *</label>
    <input type="text" [(ngModel)]="ssn" name="ssn" required>

    <label>Date of Birth *</label>
    <input type="date" [(ngModel)]="dateOfBirth" name="dateOfBirth" required>


    <label>Gender *</label>
    <select [(ngModel)]="gender" name="gender" required>
        <option value="male">Male</option>
        <option value="female">Female</option>
        <option value="not_answer">I do not wish to answer</option>
    </select>

    <br />
    <label>Are you a citizen or permanent resident of the U.S.? *</label>
    <select [(ngModel)]="citizenship" name="citizenship" required>
        <option value="citizen">Citizen</option>
        <option value="green_card">Green Card</option>
        <option value="non_citizen">No</option>
    </select>

    <ng-container *ngIf="citizenship === 'non_citizen'">
        <label>What is your work authorization? *</label>
        <select [(ngModel)]="workAuthorization" name="workAuthorization" required>
            <option value="h1b">H1-B</option>
            <option value="l2">L2</option>
            <option value="f1">F1(CPT/OPT)</option>
            <option value="h4">H4</option>
            <option value="other">Other</option>
        </select>

        <ng-container *ngIf="workAuthorization === 'f1'">
            <label>OPT Receipt</label>
            <input type="file" (change)="onFilePickedOpt($event)">
            <button (click)="onFileUpload($event)">Upload OPT Receipt</button>
        </ng-container>

        <ng-container *ngIf="workAuthorization === 'other'">
            <label>Visa Title</label>
            <input type="text" [(ngModel)]="visaTitle" name="visaTitle">
        </ng-container>

        <label>Start Date *</label>
        <input type="date" [(ngModel)]="visaStartDate" name="visaStartDate" required>

        <label>End Date *</label>
        <input type="date" [(ngModel)]="visaEndDate" name="visaEndDate" required>
    </ng-container>
    <br />
    <label>Do you have a driver's license?</label>
    <input type="checkbox" [(ngModel)]="hasDriverLicense" name="hasDriverLicense">

    <ng-container *ngIf="hasDriverLicense">
        <label>Driver's License Number *</label>
        <input type="text" [(ngModel)]="driverLicenseNumber" name="driverLicenseNumber" required>

        <label>Expiration Date *</label>
        <input type="date" [(ngModel)]="driverLicenseExpiration" name="driverLicenseExpiration" required>

        <label>Driver's License Copy</label>
        <input type="file" (change)="onFilePickedDri($event)" required>
        <button (click)="onFileUpload($event)">Upload Driver License</button>
    </ng-container>
    <br />
    <label>Reference *</label>
    <input type="text" [(ngModel)]="referenceFirstName" name="referenceFirstName" placeholder="First Name" required>
    <input type="text" [(ngModel)]="referenceLastName" name="referenceLastName" placeholder="Last Name" required>
    <input type="text" [(ngModel)]="referenceMiddleName" name="referenceMiddleName" placeholder="Middle Name">
    <input type="tel" [(ngModel)]="referencePhone" name="referencePhone" placeholder="Phone" required>
    <input type="email" [(ngModel)]="referenceEmail" name="referenceEmail" placeholder="Email" required>
    <input type="text" [(ngModel)]="referenceRelationship" name="referenceRelationship" placeholder="Relationship"
        required>
    <label>Emergency Contacts *</label>
    <button (click)="addEmergencyContact()">Add Contact</button>
    <div *ngFor="let contact of emergencyContacts; let i = index">
        <input type="text" [(ngModel)]="emergencyContacts[i].firstName" name="emergencyFirstName"
            placeholder="First Name" required>
        <input type="text" [(ngModel)]="emergencyContacts[i].lastName" name="emergencyLastName" placeholder="Last Name"
            required>
        <input type="text" [(ngModel)]="emergencyContacts[i].middleName" name="emergencyMiddleName"
            placeholder="Middle Name">
        <input type="tel" [(ngModel)]="emergencyContacts[i].phone" name="emergencyPhone" placeholder="Phone" required>
        <input type="email" [(ngModel)]="emergencyContacts[i].email" name="emergencyEmail" placeholder="Email" required>
        <input type="text" [(ngModel)]="emergencyContacts[i].relationship" name="emergencyRelationship"
            placeholder="Relationship" required>

        <button (click)="removeEmergencyContact(i)">Remove Contact</button>
    </div>


    <br />
    <div *ngIf="myForm.invalid && (myForm.dirty || myForm.touched)">
        <p>Please fill out all required fields.</p>
        <button type="submit" disabled>Submit</button>
    </div>
    <div *ngIf="!myForm.invalid && (myForm.dirty || myForm.touched)">
        <p>You can submit now.</p>
        <button type="submit" (click)="submitForm()">Submit</button>
        <!-- <button type="submit">Submit</button> -->
    </div>
</form>
<div *ngIf=" status === 'Pending'">
    <table>
        <tr>
            <th>First Name:</th>
            <th>{{profile.firstName}}</th>
        </tr>
        <tr>
            <th>Last Name:</th>
            <th>{{profile.lastName}}</th>
        </tr>
        <tr>
            <th>Address:</th>
            <th>{{profile.address.apt}} {{profile.address.street}} {{profile.address.city}} {{profile.address.state}}
                {{profile.address.zip}}</th>
        </tr>
        <tr>
            <th>Cell Phone:</th>
            <th>{{profile.cellPhoneNumber}}</th>
        </tr>
        <tr>
            <th>Car Information:</th>
            <th>{{profile.car.make}} {{profile.car.model}} {{profile.car.color}}</th>
        </tr>
        <tr>
            <th>Email:</th>
            <th>{{profile.email}}</th>
        </tr>
        <tr>
            <th>SSN:</th>
            <th>{{profile.SSN}}</th>
        </tr>
        <tr>
            <th>Date of Birth:</th>
            <th>{{profile.dateOfBirth}}</th>
        </tr>
        <tr>
            <th>Gender:</th>
            <th>{{profile.gender ? profile.gender : null}}</th>
        </tr>
        <tr>
            <th>Driver Liscense:</th>
            <th>{{profile.driverLicense.number}}</th>
        </tr>
        <tr>
            <th>Reference:</th>
            <th>{{profile.reference.firstName}} {{profile.reference.middleName}} {{profile.reference.lastName}}
                {{profile.reference.phone}} {{profile.reference.email}} {{profile.reference.relationship}}</th>
        </tr>
        <div>

        </div>
        <tr *ngFor='let contact of profile.emergencyContacts'>
            <th>Emergency Contact: </th>
            <th>{{contact.firstName}}</th>
            <th>{{contact.middleName}}</th>
            <th>{{contact.lastName}}</th>
            <th>{{contact.phone}}</th>
            <th>{{contact.email}}</th>
            <th>{{contact.relationship}}</th>
        </tr>
    </table>
    <ul>
        <li *ngFor='let file of fileList'>
            {{file}}
            <a href='http://localhost:3000/user/download/{{file}}'>Download {{file}}</a>
        </li>
    </ul>
    <button (click)='showFileList()'>Show File Summary</button>
</div>

<br />
<p *ngIf="status === 'Pending'">Please wait for HR to review your application.</p>
<p *ngIf="status === 'Approved'">Congratulations! Your application has been approved. You will now be redirected to the
    home page.</p>
<p *ngIf="status === 'Rejected'">Your application has been rejected for the following reason(s):</p>

<!-- <button (click)='navigateToEmployeeVisa()'>navigate to employee visa</button> -->